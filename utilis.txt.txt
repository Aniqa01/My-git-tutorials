This is the utility function for  version 6
This is the utility function version 6 created on 3 april 2024
